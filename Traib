from tensorflow.keras.models import Model
from tensorflow.keras.layers import Input, Dense

# Define input shape
input_shape = X_oil1_train.shape[1]  # Assuming the same number of features for all oils

# Shared Input Layer
shared_input = Input(shape=(input_shape,))

# Shared Hidden Layers
shared_layer = Dense(128, activation='relu')(shared_input)
shared_layer = Dense(64, activation='relu')(shared_layer)

# Task-specific output layers (one for each oil)
task_outputs = []
num_oils = 3  # Number of oil datasets

for i in range(num_oils):
    task_output = Dense(32, activation='relu')(shared_layer)
    task_output = Dense(1, activation='linear', name=f'oil_{i}_output')(task_output)
    task_outputs.append(task_output)

# Define the model
model = Model(inputs=shared_input, outputs=task_outputs)

# Define losses for each task
losses = {f'oil_{i}_output': 'mse' for i in range(num_oils)}

# Compile the model
model.compile(optimizer='adam', loss=losses, metrics=['mae'])

# Summary of the model
model.summary()
